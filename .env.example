# ============================================================================
# Adonis EOS - Environment Configuration Template
# ============================================================================
# Copy this file to .env and fill in your values
# NEVER commit .env to version control
# ============================================================================

# ----------------------------------------------------------------------------
# Core Application (REQUIRED)
# ----------------------------------------------------------------------------
NODE_ENV=development                    # 'development', 'production', or 'test'
PORT=3333                                # Port the server listens on
HOST=0.0.0.0                            # Host to bind to (use 0.0.0.0 for production)
APP_KEY=                                 # REQUIRED: Generate with: node ace generate:key
APP_NAME=Adonis EOS                     # Application name (used in logs)
LOG_LEVEL=info                          # Logging level: 'trace', 'debug', 'info', 'warn', 'error', 'fatal'
TZ=UTC                                  # Timezone (defaults to UTC)
ADMIN_PATH_PREFIX=admin               # Admin URL prefix (default: "admin"). Change to obfuscate admin routes (e.g., "blah" makes /admin/* become /blah/*)
APP_ENV=development                     # Alternative environment name (used by some seeders)

# ----------------------------------------------------------------------------
# Session Configuration (REQUIRED)
# ----------------------------------------------------------------------------
SESSION_DRIVER=cookie                    # 'cookie' or 'memory' (use 'cookie' for production)

# ----------------------------------------------------------------------------
# Database Configuration (REQUIRED)
# ----------------------------------------------------------------------------
DB_HOST=localhost                        # Database host
DB_PORT=5432                            # Database port
DB_USER=your_user                       # Database username
DB_PASSWORD=                            # Database password (optional but recommended)
DB_DATABASE=adonis_eos                  # Database name

# Database Connection Pool
DB_POOL_MIN=2                           # Minimum pool connections (default: 2)
DB_POOL_MAX=10                          # Maximum pool connections (default: 10)
DB_DEBUG=false                          # Enable SQL query debugging (default: false)

# ----------------------------------------------------------------------------
# Redis Configuration (REQUIRED for caching and sessions)
# ----------------------------------------------------------------------------
REDIS_HOST=localhost                    # Redis host
REDIS_PORT=6379                         # Redis port
REDIS_PASSWORD=                         # Redis password (optional)

# ----------------------------------------------------------------------------
# Internationalization (i18n)
# ----------------------------------------------------------------------------
DEFAULT_LOCALE=en                       # Default locale code (default: 'en')
SUPPORTED_LOCALES=en,es,fr              # Comma-separated list of supported locales (default: 'en')

# ----------------------------------------------------------------------------
# CMS Configuration
# ----------------------------------------------------------------------------
CMS_REVISIONS_LIMIT=20                  # Maximum revisions to keep per post (0 = unlimited, default: 20)
CMS_REVISIONS_AUTO_PRUNE=true           # Auto-delete old revisions on save (default: true)
CMS_PREVIEW_EXPIRATION_HOURS=24         # Preview link expiration in hours (default: 24)
CMS_PREVIEW_SECRET=                     # Preview token secret (defaults to APP_KEY if not set)
CMS_SOFT_DELETE_ENABLED=true            # Enable soft deletes for posts (default: true)
CMS_SOFT_DELETE_RETENTION_DAYS=30       # Days to retain soft-deleted posts (default: 30)

# ----------------------------------------------------------------------------
# Media Configuration
# ----------------------------------------------------------------------------
MEDIA_UPLOAD_DIR=uploads                # Upload directory relative to public/ (default: 'uploads')
MEDIA_MAX_FILE_SIZE=10485760            # Max file size in bytes (default: 10MB = 10485760)
MEDIA_ALLOWED_TYPES=image/jpeg,image/png,image/gif,image/webp,image/avif,application/pdf
MEDIA_DERIVATIVES=thumb:200x200_crop,small:400x,medium:800x,large:1600x
MEDIA_ADMIN_THUMBNAIL_VARIANT=thumb     # Variant name for admin thumbnails
MEDIA_ADMIN_MODAL_VARIANT=large         # Variant name for admin modal preview
MEDIA_DARK_BRIGHTNESS=0.6               # Dark mode image brightness (0.1-2.0, default: 0.6)
MEDIA_DARK_SATURATION=0.75              # Dark mode image saturation (0-2.0, default: 0.75)
MEDIA_WEBP_QUALITY=82                   # WebP quality (1-100, default: 82)

# ----------------------------------------------------------------------------
# Storage Configuration (Local or Cloudflare R2)
# ----------------------------------------------------------------------------
STORAGE_DRIVER=local                     # 'local' or 'r2' (default: 'local')

# Cloudflare R2 Configuration (required when STORAGE_DRIVER=r2)
R2_ACCOUNT_ID=                          # Cloudflare R2 account ID
R2_ENDPOINT=                            # R2 endpoint URL (auto-generated if account ID provided)
R2_BUCKET=                              # R2 bucket name
R2_ACCESS_KEY_ID=                       # R2 access key ID
R2_SECRET_ACCESS_KEY=                   # R2 secret access key
R2_PUBLIC_BASE_URL=                     # Optional CDN/custom domain base URL for R2 assets

# ----------------------------------------------------------------------------
# Protected Access (Password-protected posts)
# ----------------------------------------------------------------------------
# If site settings fields are not configured, these env vars are used as defaults.
PROTECTED_ACCESS_USERNAME=              # Default username for protected posts
PROTECTED_ACCESS_PASSWORD=              # Default password for protected posts

# ----------------------------------------------------------------------------
# Cache Configuration
# ----------------------------------------------------------------------------
CMS_SSR_CACHE_TTL=3600                  # SSR cache TTL in seconds (default: 3600)
CMS_PUBLIC_MAX_AGE=60                   # Public cache max-age in seconds (default: 60)
CMS_CDN_MAX_AGE=3600                    # CDN cache max-age in seconds (default: 3600)
CMS_SWR=604800                          # Stale-while-revalidate duration in seconds (default: 604800)

# ----------------------------------------------------------------------------
# Rate Limiting
# ----------------------------------------------------------------------------
CMS_RATE_LIMIT_REQUESTS=100             # Default requests per window (default: 100)
CMS_RATE_LIMIT_WINDOW=60                # Default window duration in seconds (default: 60)
CMS_RATE_LIMIT_AUTH_REQUESTS=5          # Auth endpoint requests per window (default: 5)
CMS_RATE_LIMIT_AUTH_WINDOW=60           # Auth endpoint window duration (default: 60)
CMS_RATE_LIMIT_API_REQUESTS=120         # API endpoint requests per window (default: 120)
CMS_RATE_LIMIT_API_WINDOW=60            # API endpoint window duration (default: 60)

# ----------------------------------------------------------------------------
# Webhooks & External Agents
# ----------------------------------------------------------------------------
CMS_WEBHOOKS_ENABLED=false              # Enable webhook dispatching (default: false)
CMS_WEBHOOK_TIMEOUT=5000                # Webhook timeout in milliseconds (default: 5000)
CMS_WEBHOOK_MAX_RETRIES=3               # Maximum retry attempts (default: 3)
CMS_WEBHOOK_SECRET=                     # Secret for signing webhook payloads (generate with: openssl rand -hex 32)
WEBHOOK_SECRET=                         # Legacy/Workflow webhook secret
AGENT_SECRET=                           # Shared secret for external AI agents
AGENT_USERS_BOOTSTRAP_DISABLED=0        # Set to '1' to disable auto-creation of agent users

# External Agent Patterns:
# AGENT_{NAME}_URL=https://...
# AGENT_{NAME}_DEV_URL=http://...
# AGENT_{NAME}_SECRET=...

# ----------------------------------------------------------------------------
# Workflows (Optional)
# ----------------------------------------------------------------------------
SLACK_WEBHOOK_URL=                      # Slack Incoming Webhook URL
N8N_WEBHOOK_URL=                        # n8n Workflow Webhook URL
WORKFLOW_USERS_BOOTSTRAP_DISABLED=0     # Set to '1' to disable auto-creation of workflow users

# ----------------------------------------------------------------------------
# Scheduler
# ----------------------------------------------------------------------------
CMS_SCHEDULER_DEV_INTERVAL=30           # Scheduler check interval in seconds (dev, default: 30)
CMS_SCHEDULER_PROD_INTERVAL=60          # Scheduler check interval in seconds (prod, default: 60)
SCHEDULER_DISABLED=0                    # Set to '1' to disable the background scheduler

# ----------------------------------------------------------------------------
# AI Provider API Keys (Optional - only needed if using AI agents)
# ----------------------------------------------------------------------------
AI_PROVIDER_OPENAI_API_KEY=             # OpenAI API key (e.g., sk-...)
AI_PROVIDER_ANTHROPIC_API_KEY=          # Anthropic (Claude) API key (e.g., sk-ant-...)
AI_PROVIDER_GOOGLE_API_KEY=             # Google (Gemini) API key
AI_PROVIDER_NANOBANANA_API_KEY=         # Nano Banana (Gemini Pro) API key

# ----------------------------------------------------------------------------
# MCP (Model Context Protocol)
# ----------------------------------------------------------------------------
# User ID for MCP system operations (should match ai@example.com user created by seeder)
MCP_SYSTEM_USER_ID=
MCP_AUTH_TOKEN=                         # Auth token for MCP server (Bearer)
MCP_AUTH_HEADER_NAME=                   # Alternative auth header name
MCP_AUTH_HEADER_VALUE=                  # Alternative auth header value
MCP_TRANSPORT=sse                       # 'sse' or 'stdio' (default: 'sse')
MCP_HOST=0.0.0.0                        # Host for MCP SSE server
MCP_PORT=8787                           # Port for MCP SSE server
MCP_QUIET=1                             # Set to '1' to suppress MCP logs (default: '1' in stdio)

# ----------------------------------------------------------------------------
# CORS & CSP Configuration (Production)
# ----------------------------------------------------------------------------
CORS_ORIGINS=                           # Comma-separated list of allowed origins
CSP_CDN_DOMAINS=                        # Comma-separated list of CDN domains for CSP

# ----------------------------------------------------------------------------
# DEV TOOLS
# ----------------------------------------------------------------------------
ENABLE_DEV_TOOLS=true                   # Enable developer-only tools/routes

# ============================================================================
# Security Notes
# ============================================================================
# 1. Generate APP_KEY: node ace generate:key
# 2. Generate webhook secret: openssl rand -hex 32
# 3. Change all default user passwords after seeding
# 4. In production, use strong passwords and rotate secrets regularly
# 5. Never commit .env to version control
# ============================================================================
